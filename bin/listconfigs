#!/usr/bin/python
"""List configs with scores.

"""

import argparse
import sys

import encoder
import pick_codec
import score_tools


def main():
  parser = argparse.ArgumentParser()
  parser.add_argument('rate')
  parser.add_argument('videofile')
  parser.add_argument("--codec")
  parser.add_argument('--component')
  parser.add_argument('--criterion', default='psnr')

  args = parser.parse_args()

  videofile = encoder.Videofile(args.videofile)

  codec = pick_codec.PickCodec(args.codec)
  codec.score_function = score_tools.PickScorer(args.criterion)

  bitrate = int(args.rate)

  encodings = codec.AllScoredEncodings(bitrate, videofile)
  encodings.encodings.sort(key=lambda foo: foo.Score())
  for encoding in encodings.encodings:
    if args.component:
      component = encoding.result[args.component]
    else:
      component = ''
    print '%s %f %s %s' % (encoding.encoder.Hashname(), encoding.Score(),
                           component,
                           encoding.encoder.OptionValues())

if __name__ == '__main__':
  sys.exit(main())
